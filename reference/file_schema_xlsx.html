<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Preview the structure of a range of an Excel worksheet. — file_schema_xlsx • RSQLite.toolkit</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Preview the structure of a range of an Excel worksheet. — file_schema_xlsx"><meta name="description" content="The file_schema_xlsx() function returns a data frame with the
schema of an Excel data table. It will read only a range of
the specified worksheet to infer column names and data types.
Then it converts them to the candidate data frame columns' names
and data types."><meta property="og:description" content="The file_schema_xlsx() function returns a data frame with the
schema of an Excel data table. It will read only a range of
the specified worksheet to infer column names and data types.
Then it converts them to the candidate data frame columns' names
and data types."><meta property="og:image" content="https://fab-algo.github.io/RSQLite.toolkit/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RSQLite.toolkit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.4.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/dealing_with_DSV_files.html">Dealing with DSV files</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fab-algo/RSQLite.toolkit/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Preview the structure of a range of an Excel worksheet.</h1>
      <small class="dont-index">Source: <a href="https://github.com/fab-algo/RSQLite.toolkit/blob/master/R/file_helpers.R" class="external-link"><code>R/file_helpers.R</code></a></small>
      <div class="d-none name"><code>file_schema_xlsx.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>file_schema_xlsx()</code> function returns a data frame with the
schema of an Excel data table. It will read only a range of
the specified worksheet to infer column names and data types.
Then it converts them to the candidate data frame columns' names
and data types.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">file_schema_xlsx</span><span class="op">(</span></span>
<span>  <span class="va">input_file</span>,</span>
<span>  <span class="va">sheet_name</span>,</span>
<span>  <span class="va">first_row</span>,</span>
<span>  <span class="va">cols_range</span>,</span>
<span>  header <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  id_quote_method <span class="op">=</span> <span class="st">"DB_NAMES"</span>,</span>
<span>  max_lines <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  null_columns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-input-file">input_file<a class="anchor" aria-label="anchor" href="#arg-input-file"></a></dt>
<dd><p>character, file name (including path) to be read.</p></dd>


<dt id="arg-sheet-name">sheet_name<a class="anchor" aria-label="anchor" href="#arg-sheet-name"></a></dt>
<dd><p>character, the name of the worksheet containing the data
table.</p></dd>


<dt id="arg-first-row">first_row<a class="anchor" aria-label="anchor" href="#arg-first-row"></a></dt>
<dd><p>integer, the row number where the data table starts.
If present, it is the row number of the header row, otherwise it is
the row number of the first row of data.</p></dd>


<dt id="arg-cols-range">cols_range<a class="anchor" aria-label="anchor" href="#arg-cols-range"></a></dt>
<dd><p>integer, a numeric vector specifying which columns in
the worksheet to be read.</p></dd>


<dt id="arg-header">header<a class="anchor" aria-label="anchor" href="#arg-header"></a></dt>
<dd><p>logical, if <code>TRUE</code> the first row contains the fields'
names. If <code>FALSE</code>, the column names will be the column names of the
Excel worksheet (i.e. letters).</p></dd>


<dt id="arg-id-quote-method">id_quote_method<a class="anchor" aria-label="anchor" href="#arg-id-quote-method"></a></dt>
<dd><p>character, used to specify how to build the SQLite
columns' names using the fields' identifiers read from the input file.
For details see the description of the <code>quote_method</code> parameter of
the <code><a href="format_column_names.html">format_column_names()</a></code> function. Defaults to <code>DB_NAMES</code>.</p></dd>


<dt id="arg-max-lines">max_lines<a class="anchor" aria-label="anchor" href="#arg-max-lines"></a></dt>
<dd><p>integer, number of lines (excluding the header) to be
read to infer columns' data types. Defaults to 100.</p></dd>


<dt id="arg-null-columns">null_columns<a class="anchor" aria-label="anchor" href="#arg-null-columns"></a></dt>
<dd><p>logical, if <code>TRUE</code> the col_type of columuns consisting
only of NAs or zero-length strings will be marked as <code>NA</code>, otherwise they
will be marked as <code>character</code>. Defaults to <code>FALSE</code></p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional parameters passed to <code><a href="https://janmarvin.github.io/openxlsx2/reference/wb_to_df.html" class="external-link">openxlsx2::wb_to_df()</a></code>
function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a data frame with these columns:</p><ul><li><p><code>col_names</code>: columns' names, after applying the selected quote method;</p></li>
<li><p><code>col_names_unquoted</code>: columns' names, unquoted; if <code>id_quote_method</code>
is set to <code>DB_NAMES</code> they will be the same as <code>col_names</code>; for other
quote methods they will be the unquoted versions of <code>col_names</code>,that
is generally the same as <code>src_names</code> unless <code>src_names</code> contain the
quoting characters;</p></li>
<li><p><code>col_types</code>: columns' R data types;</p></li>
<li><p><code>sql_types</code>: columns' SQLite data types;</p></li>
<li><p><code>src_names</code>: columns' names as they appear in the input file;</p></li>
<li><p><code>src_types</code>: data type attribute of each column, as determined by the
<code><a href="https://janmarvin.github.io/openxlsx2/reference/wb_to_df.html" class="external-link">openxlsx2::wb_to_df()</a></code> function.</p></li>
</ul></div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ludovico G. Beretta.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

