<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Load Data in SQLite from Tabular Files • RSQLite.toolkit</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Load Data in SQLite from Tabular Files">
<meta name="description" content="A lightweight wrapper around the RSQLite package for streamlined loading of data from tabular files (i,e. text delimited files like CSV and TSV, Microsoft Excel, and Arrow IPC files) in SQLite databases. Includes helper functions for inspecting the structure of the input files, and some functions to simplify activities on the SQLite tables.">
<meta property="og:description" content="A lightweight wrapper around the RSQLite package for streamlined loading of data from tabular files (i,e. text delimited files like CSV and TSV, Microsoft Excel, and Arrow IPC files) in SQLite databases. Includes helper functions for inspecting the structure of the input files, and some functions to simplify activities on the SQLite tables.">
<meta property="og:image" content="https://fab-algo.github.io/RSQLite.toolkit/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">RSQLite.toolkit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.4.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/dealing_with_DSV_files.html">Dealing with DSV files</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fab-algo/RSQLite.toolkit/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="rsqlitetoolkit-">RSQLite.toolkit 
<a class="anchor" aria-label="anchor" href="#rsqlitetoolkit-"></a>
</h1>
</div>
<!-- badges: start -->
<!-- badges: end -->
<p>RSQLite.toolkit is a lightweight wrapper around the RSQLite package for streamlined loading of data from <strong>tabular files</strong> (i.e. text delimited files like CSV and TSV, Microsoft Excel, and Arrow IPC files) in SQLite databases.</p>
<p>It also includes helper functions for inspecting the structure of the input files, and some functions to simplify activities on the SQLite tables.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of RSQLite.toolkit from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class=".pkgdown-devel">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install development version from GitHub</span></span>
<span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"fab-algo/RSQLite.toolkit"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>These basic examples show how to use the core functions of the package to load example data in different tables in a test database:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/fab-algo/RSQLite.toolkit" class="external-link">RSQLite.toolkit</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: RSQLite</span></span>
<span></span>
<span><span class="va">dbcon</span> <span class="op">&lt;-</span> <span class="fu">dbConnect</span><span class="op">(</span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu"><a href="https://rsqlite.r-dbi.org/reference/SQLite.html" class="external-link">SQLite</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"tests.sqlite"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"RSQLite.toolkit"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## creates the table ABALONE from a CSV file, adding the field 'SEQ' with the</span></span>
<span><span class="co">## ROWID of each record through the use of the parameter 'auto_pk=TRUE'</span></span>
<span><span class="fu"><a href="reference/dbTableFromDSV.html">dbTableFromDSV</a></span><span class="op">(</span>input_file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_path</span>, <span class="st">"abalone.csv"</span><span class="op">)</span>,</span>
<span>               dbcon <span class="op">=</span> <span class="va">dbcon</span>, table_name <span class="op">=</span> <span class="st">"ABALONE"</span>,</span>
<span>               drop_table <span class="op">=</span> <span class="cn">TRUE</span>, auto_pk <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">","</span>, dec <span class="op">=</span> <span class="st">"."</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4177</span></span>
<span></span>
<span><span class="co">## creates the table PORTFOLIO_PERF from Excel file, using the "all period" sheet</span></span>
<span><span class="fu"><a href="reference/dbTableFromXlsx.html">dbTableFromXlsx</a></span><span class="op">(</span>input_file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_path</span>,</span>
<span>                                       <span class="st">"stock_portfolio.xlsx"</span><span class="op">)</span>,</span>
<span>                dbcon <span class="op">=</span> <span class="va">dbcon</span>, table_name <span class="op">=</span> <span class="st">"PORTFOLIO_PERF"</span>,</span>
<span>                drop_table <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                sheet_name <span class="op">=</span> <span class="st">"all period"</span>, first_row <span class="op">=</span> <span class="fl">2</span>, cols_range <span class="op">=</span> <span class="st">"A:S"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 63</span></span>
<span></span>
<span><span class="co">## creates the table PENGUINS from Feather file</span></span>
<span><span class="fu"><a href="reference/dbTableFromFeather.html">dbTableFromFeather</a></span><span class="op">(</span>input_file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_path</span>, <span class="st">"penguins.feather"</span><span class="op">)</span>,</span>
<span>                   dbcon <span class="op">=</span> <span class="va">dbcon</span>, table_name <span class="op">=</span> <span class="st">"PENGUINS"</span>,</span>
<span>                   drop_table <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 333</span></span>
<span></span>
<span><span class="fu">dbListTables</span><span class="op">(</span><span class="va">dbcon</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ABALONE"        "PENGUINS"       "PORTFOLIO_PERF"</span></span>
<span></span>
<span><span class="fu">dbListFields</span><span class="op">(</span><span class="va">dbcon</span>, <span class="st">"ABALONE"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "Sex"     "Length"  "Diam"    "Height"  "Whole"   "Shucked" "Viscera"</span></span>
<span><span class="co">#&gt;  [8] "Shell"   "Rings"   "SEQ"</span></span>
<span><span class="fu">dbListFields</span><span class="op">(</span><span class="va">dbcon</span>, <span class="st">"PENGUINS"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "species"           "culmen_length_mm"  "culmen_depth_mm"  </span></span>
<span><span class="co">#&gt; [4] "flipper_length_mm" "body_mass_g"       "sex"</span></span>
<span><span class="fu">dbListFields</span><span class="op">(</span><span class="va">dbcon</span>, <span class="st">"PORTFOLIO_PERF"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "ID"                                   </span></span>
<span><span class="co">#&gt; [2] "Large_B_P"                            </span></span>
<span><span class="co">#&gt; [3] "Large_ROE"                            </span></span>
<span><span class="co">#&gt; [4] "Large_S_P"                            </span></span>
<span><span class="co">#&gt; [5] "Large_Return_Rate_in_the_last_quarter"</span></span>
<span></span>
<span><span class="fu">dbDisconnect</span><span class="op">(</span><span class="va">dbcon</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="core-functions">Core Functions<a class="anchor" aria-label="anchor" href="#core-functions"></a>
</h2>
<p>The basic idea behind this package is that storing all the data used throughout a data-analysis workflow in a local database is a highly efficient and effective way to manage information. The advantages of keeping raw data and their metadata together in the same database—ideally under a shared data model—far outweigh not only the additional overhead of maintaining a structured system, but also the costs and complexity involved in importing information from external files with disparate formats and conventions.</p>
<p>The purpose of this package is to reduce the burden of the last point (i.e., importing the data) as much as possible through a set of functions that read the data from the source files, create the destination table (if it does not exist), store the data there, and index it, all in one step.</p>
<p>The core functions of the package are therefore those that can be used to move data from a file to a database table:</p>
<ul>
<li><code><a href="reference/dbTableFromDSV.html">dbTableFromDSV()</a></code></li>
<li><code><a href="reference/dbTableFromXlsx.html">dbTableFromXlsx()</a></code></li>
<li><code><a href="reference/dbTableFromFeather.html">dbTableFromFeather()</a></code></li>
</ul>
<p>Together with these, there are a couple of additional functions:</p>
<ul>
<li><code><a href="reference/dbTableFromDataFrame.html">dbTableFromDataFrame()</a></code></li>
<li><code><a href="reference/dbTableFromView.html">dbTableFromView()</a></code></li>
</ul>
<p>that could be handy to move data from intermediate data structures to database tables, using the same logic of the core ones.</p>
<p>All these functions share a common calling template that is outlined in the following picture:</p>
<p><img src="reference/figures/README-dbTableFrom_template.png" alt="" width="100%" style="display: block; margin: auto;"></p>
<p>All core functions require three mandatory arguments:</p>
<ul>
<li><code>input_file</code></li>
<li><code>dbcon</code></li>
<li><code>table_name</code></li>
</ul>
<p>that have no default values. The <code><a href="reference/dbTableFromXlsx.html">dbTableFromXlsx()</a></code> requires three additional arguments (again with no defaults): <code>sheet_name</code>, <code>first_row</code>, <code>cols_range</code> that are needed to correctly locate the dataset to be imported inside the Excel file.</p>
<p>More details on the parameters and functions’ behaviour are available in the standard function documentation accessible through R’s help system.</p>
<p>Anyway, be careful with default values of all other arguments, especially when importing from <em>delimiter separated values</em> text files: the default values for input data interpretation arguments are seldom the right ones. This is also true for the default values of the functions actually used by this package to read data from files, that is:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/base/scan.html" class="external-link">base::scan()</a></code> for reading from DSV files;</li>
<li>
<code><a href="https://janmarvin.github.io/openxlsx2/reference/wb_to_df.html" class="external-link">openxlsx2::wb_to_df()</a></code> for reading from Xlsx files;</li>
<li>
<code><a href="https://arrow.apache.org/docs/r/reference/FeatherReader.html" class="external-link">arrow::FeatherReader()</a></code> for reading from Feather files.</li>
</ul>
<p>Given the high variability in how data can be stored in DSV and Excel files, there is always the possibility of passing specific parameters of the above-listed functions through the special argument “<code>...</code>”. To help with using the additional arguments of <code><a href="reference/dbTableFromDSV.html">dbTableFromDSV()</a></code>, along with those of <code><a href="https://rdrr.io/r/base/scan.html" class="external-link">base::scan()</a></code>, you can read the <strong>vignette “Dealing with DSV files”</strong> that is part of this package. The first section of the document describes how to use <code><a href="https://rdrr.io/r/base/scan.html" class="external-link">base::scan()</a></code> arguments to read complex DSV files. In the second section there is a detailed description of the issues related to the column names used in the data file and their corresponding identifiers in the SQLite table’s fields. The second section of this vignette can be helpful also when importing data from Xlsx and Feather files.</p>
</div>
<div class="section level2">
<h2 id="file-schema-inspection-functions">File Schema Inspection Functions<a class="anchor" aria-label="anchor" href="#file-schema-inspection-functions"></a>
</h2>
<p>Before loading data into your SQLite database, RSQLite.toolkit provides specialized functions to inspect the structure and schema of your input files <strong>without loading the entire dataset into memory</strong>. This is particularly useful for large files or when you need to understand the data types and column structure before importing.</p>
<p>The package includes three schema inspection functions:</p>
<ul>
<li>
<strong><code><a href="reference/file_schema_dsv.html">file_schema_dsv()</a></code></strong> - for delimiter-separated values files (CSV, TSV, etc.)</li>
<li>
<strong><code><a href="reference/file_schema_feather.html">file_schema_feather()</a></code></strong> - for Arrow Feather files<br>
</li>
<li>
<strong><code><a href="reference/file_schema_xlsx.html">file_schema_xlsx()</a></code></strong> - for Microsoft Excel files</li>
</ul>
<div class="section level3">
<h3 id="purpose-and-benefits">Purpose and Benefits<a class="anchor" aria-label="anchor" href="#purpose-and-benefits"></a>
</h3>
<p>These functions serve several important purposes:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Memory Efficiency</strong>: Preview large files without loading them completely into memory</li>
<li>
<strong>Data Type Detection</strong>: Automatically infer (or at least try to) R and SQLite data types for each column</li>
<li>
<strong>Column Name Formatting</strong>: Show how column names will be formatted for SQLite compatibility</li>
<li>
<strong>Import Planning</strong>: Help you understand the structure before using the main <code>dbTableFrom*()</code> functions</li>
<li>
<strong>Troubleshooting</strong>: Identify potential issues with file structure, encoding, or formatting</li>
</ol>
</div>
<div class="section level3">
<h3 id="what-they-return">What They Return<a class="anchor" aria-label="anchor" href="#what-they-return"></a>
</h3>
<p>All three functions return a data frame with the following key columns:</p>
<ul>
<li>
<code>col_names</code>: Column names after applying SQLite formatting rules</li>
<li>
<code>col_names_unquoted</code>: Unquoted column names (if different from <code>col_names</code>)</li>
<li>
<code>col_types</code>: Inferred R data types for each column</li>
<li>
<code>sql_types</code>: Corresponding SQLite data types</li>
<li>
<code>src_names</code>: Original column names as they appear in the source file</li>
<li>
<code>src_types</code>: Source data types (varies by file format)</li>
</ul>
</div>
<div class="section level3">
<h3 id="usage-examples">Usage Examples<a class="anchor" aria-label="anchor" href="#usage-examples"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/fab-algo/RSQLite.toolkit" class="external-link">RSQLite.toolkit</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"RSQLite.toolkit"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/file_schema_dsv.html">file_schema_dsv</a></span><span class="op">(</span>input_file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_path</span>, <span class="st">"abalone.csv"</span><span class="op">)</span>,</span>
<span>                header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">","</span>, dec <span class="op">=</span> <span class="st">"."</span><span class="op">)</span><span class="op">$</span><span class="va">schema</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;   col_names col_types sql_types src_names src_types src_is_quoted</span></span>
<span><span class="co">#&gt; 1       Sex character      TEXT       Sex      text         FALSE</span></span>
<span><span class="co">#&gt; 2    Length   numeric      REAL    Length      text         FALSE</span></span>
<span><span class="co">#&gt; 3      Diam   numeric      REAL      Diam      text         FALSE</span></span>
<span><span class="co">#&gt; 4    Height   numeric      REAL    Height      text         FALSE</span></span>
<span><span class="co">#&gt; 5     Whole   numeric      REAL     Whole      text         FALSE</span></span>
<span><span class="co">#&gt; 6   Shucked   numeric      REAL   Shucked      text         FALSE</span></span>
<span><span class="co">#&gt; 7   Viscera   numeric      REAL   Viscera      text         FALSE</span></span>
<span><span class="co">#&gt; 8     Shell   numeric      REAL     Shell      text         FALSE</span></span>
<span><span class="co">#&gt; 9     Rings   integer   INTEGER     Rings      text         FALSE</span></span>
<span></span>
<span><span class="fu"><a href="reference/file_schema_feather.html">file_schema_feather</a></span><span class="op">(</span>input_file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_path</span>,</span>
<span>                                           <span class="st">"penguins.feather"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;           col_names col_types sql_types         src_names src_types</span></span>
<span><span class="co">#&gt; 1           species character      TEXT           species      utf8</span></span>
<span><span class="co">#&gt; 2  culmen_length_mm    double      REAL  culmen_length_mm    double</span></span>
<span><span class="co">#&gt; 3   culmen_depth_mm    double      REAL   culmen_depth_mm    double</span></span>
<span><span class="co">#&gt; 4 flipper_length_mm    double      REAL flipper_length_mm    double</span></span>
<span><span class="co">#&gt; 5       body_mass_g    double      REAL       body_mass_g    double</span></span>
<span><span class="co">#&gt; 6               sex character      TEXT               sex      utf8</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="when-to-use-these-functions">When to Use These Functions<a class="anchor" aria-label="anchor" href="#when-to-use-these-functions"></a>
</h3>
<ul>
<li>
<strong>Before importing large files</strong> to understand their structure</li>
<li>
<strong>When debugging import issues</strong> to identify data type conflicts</li>
<li>
<strong>For data documentation</strong> to understand file contents without opening them</li>
<li>
<strong>When working with unfamiliar datasets</strong> to explore column names and types</li>
<li>
<strong>To verify column naming conventions</strong> will work with SQLite</li>
</ul>
<p>These <em>schema</em> functions use the same parameters as their corresponding <code>dbTableFrom*()</code> functions, making it easy to test and refine your import settings before committing to the full data load.</p>
</div>
</div>
<div class="section level2">
<h2 id="database-utility-functions">Database Utility Functions<a class="anchor" aria-label="anchor" href="#database-utility-functions"></a>
</h2>
<p>Beyond the core data import capabilities, RSQLite.toolkit provides two utility functions for simplifying database operations:</p>
<ul>
<li>
<strong><code><a href="reference/dbExecFile.html">dbExecFile()</a></code></strong> - Execute SQL statements from text files</li>
<li>
<strong><code><a href="reference/dbCopyTable.html">dbCopyTable()</a></code></strong> - Copy tables between SQLite databases</li>
</ul>
<div class="section level3">
<h3 id="dbexecfile-batch-sql-execution">dbExecFile: Batch SQL Execution<a class="anchor" aria-label="anchor" href="#dbexecfile-batch-sql-execution"></a>
</h3>
<p>The <code><a href="reference/dbExecFile.html">dbExecFile()</a></code> function allows you to execute multiple SQL statements stored in a text file, making it ideal for:</p>
<ul>
<li>
<strong>Database schema setup</strong> (creating tables, indexes, views)</li>
<li>
<strong>Batch data operations</strong> (updates, deletions, transformations)<br>
</li>
<li>
<strong>Database maintenance scripts</strong> (cleanup, optimization)</li>
<li>
<strong>Reproducible database workflows</strong> (version-controlled SQL scripts)</li>
</ul>
<p>Moreover, the possibility to read SQL statements directly from a text file avoids the need to embed long SQL instructions in strings inside the main R code, making the source more readable.</p>
<div class="section level4">
<h4 id="key-features">Key Features<a class="anchor" aria-label="anchor" href="#key-features"></a>
</h4>
<ul>
<li>
<strong>Comment stripping</strong>: Automatically removes SQL comments (lines starting with <code>--</code>)</li>
<li>
<strong>Statement splitting</strong>: Separates multiple statements using semicolons (<code>;</code>)</li>
<li>
<strong>Parameter binding</strong>: Optional support for parameterized queries</li>
<li>
<strong>Result collection</strong>: Returns results from each executed statement through a list</li>
</ul>
</div>
<div class="section level4">
<h4 id="usage-examples-1">Usage Examples<a class="anchor" aria-label="anchor" href="#usage-examples-1"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/fab-algo/RSQLite.toolkit" class="external-link">RSQLite.toolkit</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">dbcon</span> <span class="op">&lt;-</span> <span class="fu">dbConnect</span><span class="op">(</span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu"><a href="https://rsqlite.r-dbi.org/reference/SQLite.html" class="external-link">SQLite</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"tests.sqlite"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Load data from a DSV file into a database table ------------</span></span>
<span><span class="va">data_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"RSQLite.toolkit"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/dbTableFromDSV.html">dbTableFromDSV</a></span><span class="op">(</span>input_file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_path</span>, <span class="st">"abalone.csv"</span><span class="op">)</span>,</span>
<span>               dbcon <span class="op">=</span> <span class="va">dbcon</span>, table_name <span class="op">=</span> <span class="st">"ABALONE"</span>,</span>
<span>               drop_table <span class="op">=</span> <span class="cn">TRUE</span>, auto_pk <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">","</span>, dec <span class="op">=</span> <span class="st">"."</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4177</span></span>
<span><span class="co">## ------------------------------------------------------------</span></span>
<span></span>
<span><span class="co">## SQL file: each statement is separated by a semicolon -------</span></span>
<span><span class="va">sql_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"DROP TABLE IF EXISTS AVG_LEN_BY_SEX_RINGS;"</span>,</span>
<span>                  <span class="st">" "</span>,</span>
<span>                  <span class="st">"CREATE TABLE AVG_LEN_BY_SEX_RINGS "</span>,</span>
<span>                  <span class="st">"(SEX TEXT, RINGS INTEGER, NUM INTEGER, AVG_LENGTH REAL);"</span>,</span>
<span>                  <span class="st">" "</span>,</span>
<span>                  <span class="st">"INSERT INTO AVG_LEN_BY_SEX_RINGS "</span>,</span>
<span>                  <span class="st">"SELECT SEX, RINGS, COUNT(*) AS NUM, AVG(LENGTH) "</span>, </span>
<span>                  <span class="st">"AS AVG_LENGTH FROM ABALONE GROUP BY SEX, RINGS;"</span>,</span>
<span>                  <span class="st">" "</span>,</span>
<span>                  <span class="st">"SELECT * FROM AVG_LEN_BY_SEX_RINGS;"</span>,</span>
<span>                  <span class="st">" "</span>,</span>
<span>                  <span class="st">"SELECT SEX, round(WHOLE/:bin_size,0)*:bin_size as WHOLE_GRP, "</span>,</span>
<span>                  <span class="st">"COUNT(*) AS NUM, AVG(LENGTH) AS AVG_LENGTH "</span>, </span>
<span>                  <span class="st">"FROM ABALONE GROUP BY SEX, round(WHOLE/:bin_size,0)*:bin_size;"</span>,</span>
<span>                  sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sql_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".sql"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="va">sql_text</span>, con <span class="op">=</span> <span class="va">sql_file</span><span class="op">)</span></span>
<span><span class="co">## ------------------------------------------------------------</span></span>
<span></span>
<span><span class="co">## Execute SQL statements from the file -----------------------</span></span>
<span><span class="va">plist</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>q1<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>           q2<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>           q3<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>           q4<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>           q5<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>bin_size <span class="op">=</span> <span class="fl">0.025</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dbExecFile.html">dbExecFile</a></span><span class="op">(</span>input_file <span class="op">=</span> <span class="va">sql_file</span>, dbcon <span class="op">=</span> <span class="va">dbcon</span>, </span>
<span>                  plist <span class="op">=</span> <span class="va">plist</span><span class="op">)</span></span>
<span><span class="co">## ------------------------------------------------------------</span></span>
<span></span>
<span><span class="co">## Check results ----------------------------------------------</span></span>
<span><span class="fu">dbListTables</span><span class="op">(</span><span class="va">dbcon</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ABALONE"              "AVG_LEN_BY_SEX_RINGS" "PENGUINS"            </span></span>
<span><span class="co">#&gt; [4] "PORTFOLIO_PERF"</span></span>
<span><span class="fu">dbListFields</span><span class="op">(</span><span class="va">dbcon</span>, <span class="st">"AVG_LEN_BY_SEX_RINGS"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "SEX"        "RINGS"      "NUM"        "AVG_LENGTH"</span></span>
<span></span>
<span><span class="va">res</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="va">res</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="va">res</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span></span>
<span><span class="va">res</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;    SEX RINGS NUM AVG_LENGTH</span></span>
<span><span class="co">#&gt; 1    F     5   4  0.3237500</span></span>
<span><span class="co">#&gt; 2    F     6  16  0.4628125</span></span>
<span><span class="co">#&gt; 3    F     7  44  0.4678409</span></span>
<span><span class="co">#&gt; 4    F     8 122  0.5380328</span></span>
<span><span class="co">#&gt; 5    F     9 238  0.5746008</span></span>
<span><span class="co">#&gt; 6    F    10 248  0.5822782</span></span>
<span><span class="co">#&gt; 7    F    11 200  0.6137000</span></span>
<span><span class="co">#&gt; 8    F    12 128  0.5949219</span></span>
<span><span class="co">#&gt; 9    F    13  88  0.5814773</span></span>
<span><span class="co">#&gt; 10   F    14  56  0.5960714</span></span>
<span></span>
<span><span class="va">res</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;    Sex WHOLE_GRP NUM AVG_LENGTH</span></span>
<span><span class="co">#&gt; 1    F     0.075   1  0.2750000</span></span>
<span><span class="co">#&gt; 2    F     0.150   3  0.3000000</span></span>
<span><span class="co">#&gt; 3    F     0.175   2  0.3425000</span></span>
<span><span class="co">#&gt; 4    F     0.200   9  0.3444444</span></span>
<span><span class="co">#&gt; 5    F     0.225   5  0.3730000</span></span>
<span><span class="co">#&gt; 6    F     0.250   3  0.3733333</span></span>
<span><span class="co">#&gt; 7    F     0.275  10  0.3700000</span></span>
<span><span class="co">#&gt; 8    F     0.300   5  0.3900000</span></span>
<span><span class="co">#&gt; 9    F     0.325   7  0.4000000</span></span>
<span><span class="co">#&gt; 10   F     0.350   9  0.4038889</span></span>
<span><span class="co">## ------------------------------------------------------------</span></span>
<span></span>
<span><span class="co">## Cleanup ----------------------------------------------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">sql_file</span><span class="op">)</span></span>
<span><span class="fu">dbDisconnect</span><span class="op">(</span><span class="va">dbcon</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="dbcopytable-cross-database-table-operations">dbCopyTable: Cross-Database Table Operations<a class="anchor" aria-label="anchor" href="#dbcopytable-cross-database-table-operations"></a>
</h3>
<p>The <code><a href="reference/dbCopyTable.html">dbCopyTable()</a></code> function enables you to copy entire tables between different SQLite database files, useful for:</p>
<ul>
<li>
<strong>Data archiving</strong> (moving historical data to archive databases)</li>
<li>
<strong>Database splitting</strong> (distributing data across multiple files)</li>
<li>
<strong>Backup operations</strong> (creating table-specific backups)</li>
<li>
<strong>Data sharing</strong> (copying tables to shared databases)</li>
<li>
<strong>Development workflows</strong> (copying production data to test environments)</li>
</ul>
<p>The typical scenario where this function becomes really useful is when you want to start a new analysis workflow in a new environment and you want to carry over part of the data you used in a previous one. This function allows you to move whole tables from the SQLite database you used in the old workflow to the new database, so that you can add more recent data or you can reuse previous results.</p>
<div class="section level4">
<h4 id="key-features-1">Key Features<a class="anchor" aria-label="anchor" href="#key-features-1"></a>
</h4>
<ul>
<li>
<strong>Flexible copying</strong>: Append to existing tables or create new ones</li>
<li>
<strong>Index preservation</strong>: Optionally copy indexes along with data</li>
<li>
<strong>Cross-database operation</strong>: Works between different SQLite database files</li>
<li>
<strong>Safe operations</strong>: Option to drop/recreate target tables safely</li>
</ul>
</div>
<div class="section level4">
<h4 id="usage-examples-2">Usage Examples<a class="anchor" aria-label="anchor" href="#usage-examples-2"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Copy a table from one database to another</span></span>
<span><span class="fu"><a href="reference/dbCopyTable.html">dbCopyTable</a></span><span class="op">(</span></span>
<span>  db_file_src <span class="op">=</span> <span class="st">"source.sqlite"</span>, </span>
<span>  db_file_tgt <span class="op">=</span> <span class="st">"backup.sqlite"</span>,</span>
<span>  table_name <span class="op">=</span> <span class="st">"sales_data"</span>,</span>
<span>  drop_table <span class="op">=</span> <span class="cn">TRUE</span>,        <span class="co"># Recreate table if it exists</span></span>
<span>  copy_indexes <span class="op">=</span> <span class="cn">TRUE</span>       <span class="co"># Copy indexes too</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Append data to existing table (no index copying)</span></span>
<span><span class="fu"><a href="reference/dbCopyTable.html">dbCopyTable</a></span><span class="op">(</span></span>
<span>  db_file_src <span class="op">=</span> <span class="st">"daily_data.sqlite"</span>,</span>
<span>  db_file_tgt <span class="op">=</span> <span class="st">"master.sqlite"</span>, </span>
<span>  table_name <span class="op">=</span> <span class="st">"transactions"</span>,</span>
<span>  drop_table <span class="op">=</span> <span class="cn">FALSE</span>        <span class="co"># Append to existing table</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Archive old data</span></span>
<span><span class="fu"><a href="reference/dbCopyTable.html">dbCopyTable</a></span><span class="op">(</span></span>
<span>  db_file_src <span class="op">=</span> <span class="st">"production.sqlite"</span>,</span>
<span>  db_file_tgt <span class="op">=</span> <span class="st">"archive_2024.sqlite"</span>,</span>
<span>  table_name <span class="op">=</span> <span class="st">"historical_sales"</span>,</span>
<span>  drop_table <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  copy_indexes <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="when-to-use-these-functions-1">When to Use These Functions:<a class="anchor" aria-label="anchor" href="#when-to-use-these-functions-1"></a>
</h3>
<p><strong>Use <code><a href="reference/dbExecFile.html">dbExecFile()</a></code> when:</strong></p>
<ul>
<li>Setting up complex database schemas</li>
<li>Running maintenance or cleanup scripts</li>
<li>Executing version-controlled SQL migrations</li>
<li>Performing batch data transformations</li>
<li>Need to run multiple related SQL statements</li>
</ul>
<p><strong>Use <code><a href="reference/dbCopyTable.html">dbCopyTable()</a></code> when:</strong></p>
<ul>
<li>Creating backups of specific tables</li>
<li>Moving data between environments (dev/test/prod)</li>
<li>Archiving historical data</li>
<li>Splitting large databases into smaller files</li>
<li>Sharing specific datasets with collaborators</li>
</ul>
<p>These utility functions complement the core data import functions by providing database management capabilities that are often needed in real-world data analysis workflows.</p>
</div>
</div>
<div class="section level2">
<h2 id="data-sources">Data Sources<a class="anchor" aria-label="anchor" href="#data-sources"></a>
</h2>
<p>The example datasets, included in the <code>extdata</code> package directory, have been retrieved from the following sources:</p>
<ul>
<li>
<code>"abalone.csv"</code>: Predicting the age of abalone from physical measurements. Source link: <a href="https://archive.ics.uci.edu/dataset/1/abalone" class="external-link uri">https://archive.ics.uci.edu/dataset/1/abalone</a>
</li>
<li>
<code>"stock_portfolio.xlsx"</code>: Stock portfolio performance under a new weighted scoring stock selection model. Source link: <a href="https://archive.ics.uci.edu/dataset/390/stock+portfolio+performance" class="external-link uri">https://archive.ics.uci.edu/dataset/390/stock+portfolio+performance</a>
</li>
<li>
<code>"penguins.feather"</code>: The Palmer Archipelago’s penguins data set. Source link: <a href="https://allisonhorst.github.io/palmerpenguins/" class="external-link uri">https://allisonhorst.github.io/palmerpenguins/</a>. The “feather” file format of the dataset was downloaded from <a href="https://github.com/lmassaron/datasets" class="external-link uri">https://github.com/lmassaron/datasets</a>.</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/fab-algo/RSQLite.toolkit/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/fab-algo/RSQLite.toolkit/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing RSQLite.toolkit</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Ludovico G. Beretta <br><small class="roles"> Author, maintainer, copyright holder </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ludovico G. Beretta.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
